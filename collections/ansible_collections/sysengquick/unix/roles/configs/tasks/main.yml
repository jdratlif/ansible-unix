---
- name: Vars block
  vars:
    configs_opts: "{{ configs_defaults | combine(item.value) }}"
    configs_defaults:
      directory: "{{ user_info.home }}/.config/{{ item.key }}"
      files: ["{{ item.key }}.conf"]
  block:
    - name: Create application config file directories
      ansible.builtin.file:
        path: "{{ configs_opts.directory }}"
        state: directory
        owner: "{{ ansible_user }}"
        group: "{{ ansible_user }}"
        mode: "0755"
      loop: "{{ configs_files_final }}"
      when: configs_opts.directory

    - name: Create config files for {{ item.key }}
      ansible.builtin.include_tasks: includes/files.yml
      loop: "{{ configs_files_final }}"
